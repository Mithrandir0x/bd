
DROP TABLE IF EXISTS "MOVIMENT";
DROP TABLE IF EXISTS "PARTIDA";
DROP TABLE IF EXISTS "JUTGE";
DROP TABLE IF EXISTS "JUGADOR";
DROP TABLE IF EXISTS "TAQUILLER";
DROP TABLE IF EXISTS "JORNADA";
DROP TABLE IF EXISTS "SALA";
DROP TABLE IF EXISTS "HOTEL";
DROP TABLE IF EXISTS "PAIS";

-- -----------------------------------------------------
-- "PAIS"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "PAIS" (
  "NOM" VARCHAR(32) NOT NULL,
  PRIMARY KEY ("NOM")
);

-- -----------------------------------------------------
-- "HOTEL"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "HOTEL" (
  "NOM" VARCHAR(45) NULL,
  PRIMARY KEY ("NOM")
);

-- -----------------------------------------------------
-- "SALA"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "SALA" (
  "HOTEL" VARCHAR(45) NOT NULL,
  "NOM" VARCHAR(45) NULL,
  "AFORAMENT" INTEGER DEFAULT 0,
  PRIMARY KEY ("HOTEL", "NOM"),
  FOREIGN KEY ("HOTEL") REFERENCES "HOTEL" ("NOM")
);

-- -----------------------------------------------------
-- "JORNADA"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "JORNADA" (
  "ID" INTEGER NOT NULL,
  "ORDRE" INTEGER NULL,
  "DATA_REALITZACIO" TIMESTAMP NULL,
  PRIMARY KEY ("ID")
);

--   "GENERE" DOMAIN {'Sr.', 'Sra.'}

-- -----------------------------------------------------
-- "TAQUILLER"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "TAQUILLER" (
  "DNI" VARCHAR(16) NOT NULL,
  "NOM" VARCHAR(32) NOT NULL,
  "TELEFON" VARCHAR(32) NULL,
  "GENERE" VARCHAR(4) NOT NULL,
  "ENTRADES_VENUDES" INTEGER DEFAULT 0,
  "PAIS" VARCHAR(32) NOT NULL,
  PRIMARY KEY ("DNI"),
  FOREIGN KEY ("PAIS") REFERENCES "PAIS" ("NOM")
);

-- -----------------------------------------------------
-- "JUGADOR"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "JUGADOR" (
  "DNI" VARCHAR(16) NOT NULL,
  "NOM" VARCHAR(32) NOT NULL,
  "TELEFON" VARCHAR(32) NULL,
  "GENERE" VARCHAR(4) NOT NULL,
  "PARTIDES_GUANYADES" INTEGER DEFAULT 0,
  "PARTIDES_PERDUDES" INTEGER DEFAULT 0,
  "HOTEL" VARCHAR(45) NULL,
  "PAIS" VARCHAR(32) NOT NULL,
  PRIMARY KEY ("DNI"),
  FOREIGN KEY ("HOTEL") REFERENCES "HOTEL" ("NOM"),
  FOREIGN KEY ("PAIS") REFERENCES "PAIS" ("NOM")
);

-- -----------------------------------------------------
-- "JUTGE"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "JUTGE" (
  "DNI" VARCHAR(16) NOT NULL,
  "NOM" VARCHAR(32) NOT NULL,
  "TELEFON" VARCHAR(32) NULL,
  "GENERE" VARCHAR(4) NOT NULL,
  "VICTORIES_BLANQUES" INTEGER DEFAULT 0,
  "VICTORIES_NEGRES" INTEGER DEFAULT 0,
  "TAULES" INTEGER DEFAULT 0,
  "HOTEL" VARCHAR(45) NULL,
  "PAIS" VARCHAR(32) NOT NULL,
  PRIMARY KEY ("DNI"),
  FOREIGN KEY ("HOTEL") REFERENCES "HOTEL" ("NOM"),
  FOREIGN KEY ("PAIS") REFERENCES "PAIS" ("NOM")
);

-- -----------------------------------------------------
-- "PARTIDA"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "PARTIDA" (
  "ID" INTEGER NOT NULL,
  "GUANYADOR" VARCHAR(1) NULL,
  "JUTGE" VARCHAR(16) NOT NULL,
  "BLANQUES" VARCHAR(16) NOT NULL,
  "NEGRES" VARCHAR(16) NOT NULL,
  "JORNADA" INTEGER NOT NULL,
  "HOTEL" VARCHAR(45) NOT NULL,
  "SALA" VARCHAR(45) NOT NULL,
  "ENTRADES_VENUDES" INTEGER DEFAULT 0,
  PRIMARY KEY ("ID"),
  FOREIGN KEY ("JUTGE") REFERENCES "JUTGE" ("DNI"),
  FOREIGN KEY ("BLANQUES") REFERENCES "JUGADOR" ("DNI"),
  FOREIGN KEY ("NEGRES") REFERENCES "JUGADOR" ("DNI"),
  FOREIGN KEY ("JORNADA") REFERENCES "JORNADA" ("ID"),
  FOREIGN KEY ("HOTEL", "SALA") REFERENCES "SALA" ("HOTEL", "NOM"),
  CONSTRAINT "JUGADORS_DIFERENTS" CHECK ( "BLANQUES" != "NEGRES" )
);

-- -----------------------------------------------------
-- "MOVIMENT"
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS "MOVIMENT" (
  "PARTIDA" INTEGER NOT NULL,
  "ORDRE" INTEGER NOT NULL,
  "DESCRIPCIO" VARCHAR(64) NOT NULL,
  FOREIGN KEY ("PARTIDA") REFERENCES "PARTIDA" ("ID")
);

-- -----------------------------------------------------
-- ENTRADES_DISPONIBLES
-- -----------------------------------------------------
DROP FUNCTION IF EXISTS ENTRADES_DISPONIBLES(VARCHAR, VARCHAR, INTEGER);
CREATE OR REPLACE FUNCTION ENTRADES_DISPONIBLES(VARCHAR, VARCHAR, INTEGER) RETURNS INTEGER AS $$
DECLARE
    hotel ALIAS FOR $1;
    sala ALIAS FOR $2;
    jornada ALIAS FOR $3;
    entrades_disponibles INTEGER;
BEGIN
    SELECT
        INTO entrades_disponibles S."AFORAMENT" - SUM("ENTRADES_VENUDES")
    FROM
        "PARTIDA" P, "SALA" S
    WHERE
        P."HOTEL" = hotel AND
        P."SALA" = sala AND
        P."JORNADA" = jornada AND
        P."HOTEL" = S."HOTEL" AND
        P."SALA" = S."NOM"
    GROUP BY
        S."HOTEL", S."NOM";
    RETURN entrades_disponibles;
END;
$$ LANGUAGE 'plpgsql';

-- -----------------------------------------------------
-- ENTRADES_JORNADA
-- -----------------------------------------------------
DROP FUNCTION IF EXISTS ENTRADES_JORNADA(INTEGER);
CREATE OR REPLACE FUNCTION ENTRADES_JORNADA(INTEGER)
RETURNS TABLE("HOTEL" VARCHAR, "SALA" VARCHAR, "ENTRADES" INTEGER) AS $$
DECLARE
    jornada ALIAS FOR $1;
BEGIN
    RETURN QUERY
        SELECT
            *
        FROM (
            SELECT
                S."HOTEL", S."NOM",
                ENTRADES_DISPONIBLES(S."HOTEL", S."NOM", jornada) AS "ENTRADES"
            FROM
                "SALA" S
            ) AS P
        WHERE
            P."ENTRADES" IS NOT NULL;
END;
$$ LANGUAGE 'plpgsql';

-- -----------------------------------------------------
-- FINALISTES
-- -----------------------------------------------------
DROP FUNCTION IF EXISTS FINALISTES();
CREATE OR REPLACE FUNCTION FINALISTES()
RETURNS TABLE("NOM" VARCHAR, "PAIS" VARCHAR, "PARTIDES_GUANYADES" INTEGER) AS $$
BEGIN
    RETURN QUERY
        SELECT
            "NOM", "PAIS", "PARTIDES_GUANYADES"
        FROM
            "JUGADOR"
        ORDER BY
            "PARTIDES_GUANYADES" DESC
        LIMIT 3;
END;
$$ LANGUAGE 'plpgsql';

-- -----------------------------------------------------
-- MAX_PAIS_VICTORIES
-- -----------------------------------------------------
DROP FUNCTION IF EXISTS MAX_PAIS_VICTORIES();
CREATE OR REPLACE FUNCTION MAX_PAIS_VICTORIES()
RETURNS TABLE("PAIS" VARCHAR, "VICTORIES" INTEGER) AS $$
BEGIN
    RETURN QUERY
        SELECT
            "PAIS", SUM("PARTIDES_GUANYADES") AS VICTORIES
        FROM
            "JUGADOR"
        GROUP BY
            "PAIS"
        ORDER BY
            "VICTORIES" DESC
        LIMIT 1;
END;
$$ LANGUAGE 'plpgsql';

-- -----------------------------------------------------
-- MAX_DURACIO_PARTIDA
-- -----------------------------------------------------
DROP FUNCTION IF EXISTS MAX_DURACIO_PARTIDA();
CREATE OR REPLACE FUNCTION MAX_DURACIO_PARTIDA()
RETURNS TABLE("PARTIDA" VARCHAR, "QUANTITAT_MOVIMENTS" INTEGER) AS $$
BEGIN
    RETURN QUERY
        SELECT
            "PARTIDA", COUNT(*) AS "QUANTITAT_MOVIMENTS"
        FROM
            "MOVIMENT"
        GROUP BY
            "PARTIDA"
        ORDER BY
            "QUANTITAT_MOVIMENTS" DESC
        LIMIT 1;
END;
$$ LANGUAGE 'plpgsql';

-- -----------------------------------------------------
-- DECIDIR_GUANYADOR
--   In Chess Algebraic Notation, the winner is noted:
--
--     1-0 : White wins
--     0-1 : Black wins
--
--   For noting ties, simply use 0-0.
-- -----------------------------------------------------
DROP FUNCTION IF EXISTS DECIDIR_GUANYADOR() CASCADE;
CREATE OR REPLACE FUNCTION DECIDIR_GUANYADOR() RETURNS TRIGGER AS $$
DECLARE
    winner TEXT;
    partida "PARTIDA"%ROWTYPE;
BEGIN
    SELECT * INTO partida FROM "PARTIDA" WHERE "ID" = NEW."PARTIDA";
    IF NEW."DESCRIPCIO" = '1-0' THEN
        UPDATE "JUGADOR" SET "PARTIDES_GUANYADES" = "PARTIDES_GUANYADES" + 1 WHERE "DNI" = partida."BLANQUES";
        UPDATE "JUGADOR" SET "PARTIDES_PERDUDES" = "PARTIDES_PERDUDES" + 1 WHERE "DNI" = partida."NEGRES";
        UPDATE "JUTGE" SET "VICTORIES_BLANQUES" = "VICTORIES_BLANQUES" + 1 WHERE "DNI" = partida."JUTGE";
        UPDATE "PARTIDA" SET "GUANYADOR" = 'B' WHERE "ID" = NEW."PARTIDA";
    END IF;
    
    IF NEW."DESCRIPCIO" = '0-1' THEN
        UPDATE "JUGADOR" SET "PARTIDES_GUANYADES" = "PARTIDES_GUANYADES" + 1 WHERE "DNI" = partida."NEGRES";
        UPDATE "JUGADOR" SET "PARTIDES_PERDUDES" = "PARTIDES_PERDUDES" + 1 WHERE "DNI" = partida."BLANQUES";
        UPDATE "JUTGE" SET "VICTORIES_BLANQUES" = "VICTORIES_NEGRES" + 1 WHERE "DNI" = partida."JUTGE";
        UPDATE "PARTIDA" SET "GUANYADOR" = 'N' WHERE "ID" = NEW."PARTIDA";
    END IF;
    
    IF NEW."DESCRIPCIO" = '0-0' THEN
        UPDATE "JUTGE" SET "TAULES" = "TAULES" + 1 WHERE "DNI" = partida."JUTGE";
        UPDATE "PARTIDA" SET "GUANYADOR" = 'T' WHERE "ID" = NEW."PARTIDA";
    END IF;
    
    RETURN NEW;
END;
$$ LANGUAGE 'plpgsql';

CREATE TRIGGER DECIDEIX_GUANYADOR
    AFTER INSERT ON "MOVIMENT"
    FOR EACH ROW EXECUTE PROCEDURE DECIDIR_GUANYADOR();

-- -----------------------------------------------------
-- VERIFICAR_NACIONALITATS
-- -----------------------------------------------------
DROP FUNCTION IF EXISTS VERIFICAR_NACIONALITATS() CASCADE;
CREATE OR REPLACE FUNCTION VERIFICAR_NACIONALITATS() RETURNS TRIGGER AS $$
DECLARE
    nacionalitat_jutge TEXT;
    nacionalitat_blanques TEXT;
    nacionalitat_negres TEXT;
BEGIN
    SELECT INTO nacionalitat_jutge "PAIS" FROM "JUTGE" WHERE "DNI" = NEW."JUTGE";
    SELECT INTO nacionalitat_blanques "PAIS" FROM "JUGADOR" WHERE "DNI" = NEW."BLANQUES";
    SELECT INTO nacionalitat_negres "PAIS" FROM "JUGADOR" WHERE "DNI" = NEW."NEGRES";
    
    IF nacionalitat_jutge = nacionalitat_blanques THEN
        RAISE EXCEPTION 'BLANQUES TÉ LA MATEIXA NACIONALITAT QUE EL JUTGE';
    END IF;

    IF nacionalitat_jutge = nacionalitat_negres THEN
        RAISE EXCEPTION 'NEGRES TÉ LA MATEIXA NACIONALITAT QUE EL JUTGE';
    END IF;

    RETURN NEW;
END;
$$ LANGUAGE 'plpgsql';

CREATE TRIGGER VERIFICA_NACIONALITATS
    BEFORE INSERT ON "PARTIDA"
    FOR EACH ROW EXECUTE PROCEDURE VERIFICAR_NACIONALITATS();

INSERT INTO "PAIS" ("NOM") VALUES ('Alemanya');
INSERT INTO "PAIS" ("NOM") VALUES ('Anglaterra');
INSERT INTO "PAIS" ("NOM") VALUES ('Espanya');
INSERT INTO "PAIS" ("NOM") VALUES ('Estats Units');
INSERT INTO "PAIS" ("NOM") VALUES ('França');
INSERT INTO "PAIS" ("NOM") VALUES ('Gales');
INSERT INTO "PAIS" ("NOM") VALUES ('Itàlia');
INSERT INTO "PAIS" ("NOM") VALUES ('Polònia');
INSERT INTO "PAIS" ("NOM") VALUES ('Rússia');
INSERT INTO "PAIS" ("NOM") VALUES ('Xina');
INSERT INTO "PAIS" ("NOM") VALUES ('Índia');

INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Antemare');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Caesar Palace');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Calipolis');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Capri');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Flamingo');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Hilton');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Holiday Inn');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Melià');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Miracle');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Montserrat');
INSERT INTO "HOTEL" ("NOM") VALUES ('Hotel Terramar');

INSERT INTO "SALA" ("HOTEL", "NOM", "AFORAMENT") VALUES ('Hotel Capri', 'Gènova', '25');
INSERT INTO "SALA" ("HOTEL", "NOM", "AFORAMENT") VALUES ('Hotel Antemare', 'Venecia', '10');
INSERT INTO "SALA" ("HOTEL", "NOM", "AFORAMENT") VALUES ('Hotel Montserrat', 'Victòria', '20');
INSERT INTO "SALA" ("HOTEL", "NOM", "AFORAMENT") VALUES ('Hotel Calipolis', 'Victòria', '15');
INSERT INTO "SALA" ("HOTEL", "NOM", "AFORAMENT") VALUES ('Hotel Montserrat', 'Ducci', '12');
INSERT INTO "SALA" ("HOTEL", "NOM", "AFORAMENT") VALUES ('Hotel Montserrat', 'Artemisa', '30');

INSERT INTO "TAQUILLER" ("DNI", "NOM", "TELEFON", "GENERE", "PAIS", "ENTRADES_VENUDES") VALUES ('32013847R','Maria','683372388','Sra.','Espanya','0');
INSERT INTO "TAQUILLER" ("DNI", "NOM", "TELEFON", "GENERE", "PAIS", "ENTRADES_VENUDES") VALUES ('38227338T','Pere','633728377','Sr.','Espanya','0');
INSERT INTO "TAQUILLER" ("DNI", "NOM", "TELEFON", "GENERE", "PAIS", "ENTRADES_VENUDES") VALUES ('43382738F','Gertrudis','602833740','Sra.','Espanya','0');

INSERT INTO "JUTGE" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "TAULES", "VICTORIES_BLANQUES", "VICTORIES_NEGRES") VALUES ('20100393R','Benjumea Azlatiletamendi',NULL,'Sr.','Hotel Capri','França','0','0','0');
INSERT INTO "JUTGE" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "TAULES", "VICTORIES_BLANQUES", "VICTORIES_NEGRES") VALUES ('20200288L','Illiech Vladimir',NULL,'Sra.','Hotel Capri','Estats Units','0','0','0');
INSERT INTO "JUTGE" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "TAULES", "VICTORIES_BLANQUES", "VICTORIES_NEGRES") VALUES ('20300643G','Pérez Lucián',NULL,'Sr.','Hotel Capri','Rússia','0','0','0');
INSERT INTO "JUTGE" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "TAULES", "VICTORIES_BLANQUES", "VICTORIES_NEGRES") VALUES ('20400453H','Roberto Mandini',NULL,'Sr.','Hotel Capri','Itàlia','0','0','0');

INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11800','Alexander Morozevich',NULL,'Sr.','Hotel Capri','Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10300','Anatoli Karpov',NULL,'Sr.','Hotel Antemare','Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12700123A','Anish Girl',NULL,'Sr.','Hotel Melià','Gales','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10000456H','Bobby Fischer',NULL,'Sr.','Hotel Hilton','Estats Units','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11500678S','Boris Gelfand',NULL,'Sr.','Hotel Antemare','Anglaterra','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11000901D','Charles Stanley',NULL,'Sr.','Hotel Calipolis','Estats Units','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12800234A','Emanuel Lasker',NULL,'Sr.','Hotel Caesar Palace','Estats Units','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11900147M','Étienne Bacrot',NULL,'Sra.','Hotel Flamingo','França','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11700269G','Evgeny Alekseev',NULL,'Sr.','Hotel Flamingo','Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11600283R','Fabiano Caruana',NULL,'Sr.','Hotel Holiday Inn','Itàlia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10100383F','Garry Kasparov',NULL,'Sr.','Hotel Capri','Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11200393J','George Henry Mackenzie',NULL,'Sr.',NULL,'Anglaterra','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('13000838P','José Raúl Capablanca',NULL,'Sr.','Hotel Hilton','Espanya','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('13100121L','Judit Polgar',NULL,'Sra.','Hotel Melià','Anglaterra','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12500778U','Larry Christiansen',NULL,'Sr.','Hotel Caesar Palace','Estats Units','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12000922R','Levon Aronian',NULL,'Sr.','Hotel Antemare','França','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11400212V','Magnus Carlsen',NULL,'Sr.','Hotel Terramar','Anglaterra','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12900232W','Max Euwe',NULL,'Sr.','Hotel Antemare','Anglaterra','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10900331F','Maya Chiburdanidze',NULL,'Sra.','Hotel Flamingo','Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10400222T','Mijail Botvínnik',NULL,'Sr.',NULL,'Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10200442T','Mijail Tahl',NULL,'Sr.','Hotel Miracle','Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10600993N','Paul Keres',NULL,'Sr.','Hotel Terramar','França','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11100199M','Paul Morphy',NULL,'Sr.','Hotel Miracle','Estats Units','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12400229R','Ray Robson',NULL,'Sr.','Hotel Holiday Inn','Anglaterra','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12600221Y','Robert Hess',NULL,'Sr.','Hotel Terramar','Estats Units','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('11300443Y','S. Lipschütz',NULL,'Sr.','Hotel Miracle','Alemanya','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12200333P','Shakhriyar Mamedyarov',NULL,'Sr.',NULL,'Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10700775L','Topalov',NULL,'Sr.','Hotel Capri','Rússia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12300335K','Viktor Laznicka',NULL,'Sr.','Hotel Montserrat','Polònia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10500332J','Viswanathan Anand',NULL,'Sr.','Hotel Montserrat','Índia','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('12100887M','Wang Hao',NULL,'Sr.','Hotel Holiday Inn','Xina','0','0');
INSERT INTO "JUGADOR" ("DNI", "NOM", "TELEFON", "GENERE", "HOTEL", "PAIS", "PARTIDES_PERDUDES", "PARTIDES_GUANYADES") VALUES ('10800332K','Wilhelm Steinitz',NULL,'Sr.',NULL,'Alemanya','0','0');

INSERT INTO "JORNADA" ("ID", "DATA_REALITZACIO") VALUES ('1', NULL);
INSERT INTO "JORNADA" ("ID", "DATA_REALITZACIO") VALUES ('2', NULL);
INSERT INTO "JORNADA" ("ID", "DATA_REALITZACIO") VALUES ('3', NULL);
INSERT INTO "JORNADA" ("ID", "DATA_REALITZACIO") VALUES ('4', NULL);
INSERT INTO "JORNADA" ("ID", "DATA_REALITZACIO") VALUES ('5', NULL);

INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('1',NULL,'20100393R','10000456H','10100383F','1','Hotel Capri','Gènova','25');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('2',NULL,'20100393R','10200442T','10300','1','Hotel Capri','Gènova','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('3',NULL,'20100393R','10400222T','10500332J','1','Hotel Capri','Gènova','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('4',NULL,'20200288L','10600993N','10700775L','1','Hotel Capri','Gènova','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('5',NULL,'20100393R','10800332K','10900331F','1','Hotel Capri','Gènova','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('6',NULL,'20100393R','11000901D','11100199M','1','Hotel Capri','Gènova','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('7',NULL,'20100393R','11200393J','11300443Y','1','Hotel Capri','Gènova','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('8',NULL,'20100393R','11400212V','11500678S','1','Hotel Capri','Gènova','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('9',NULL,'20100393R','11600283R','11700269G','1','Hotel Antemare','Venecia','10');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('10',NULL,'20200288L','11800','11900147M','1','Hotel Antemare','Venecia','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('11',NULL,'20200288L','12000922R','12100887M','1','Hotel Antemare','Venecia','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('12',NULL,'20200288L','12200333P','12300335K','1','Hotel Antemare','Venecia','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('13',NULL,'20300643G','12400229R','12500778U','1','Hotel Antemare','Venecia','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('14',NULL,'20300643G','12600221Y','12700123A','1','Hotel Antemare','Venecia','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('15',NULL,'20300643G','12800234A','12900232W','1','Hotel Antemare','Venecia','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('16',NULL,'20300643G','13000838P','13100121L','1','Hotel Antemare','Venecia','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('17',NULL,'20400453H','10300','10000456H','2','Hotel Montserrat','Victòria','18');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('18',NULL,'20400453H','10500332J','10700775L','2','Hotel Montserrat','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('19',NULL,'20400453H','11000901D','10800332K','2','Hotel Montserrat','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('20',NULL,'20400453H','11300443Y','11500678S','2','Hotel Montserrat','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('21',NULL,'20300643G','11600283R','11900147M','2','Hotel Montserrat','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('22',NULL,'20200288L','12000922R','12200333P','2','Hotel Montserrat','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('23',NULL,'20300643G','12500778U','12700123A','2','Hotel Montserrat','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('24',NULL,'20300643G','12800234A','13100121L','2','Hotel Montserrat','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('25',NULL,'20300643G','10000456H','10500332J','3','Hotel Calipolis','Victòria','8');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('26',NULL,'20300643G','11000901D','11500678S','3','Hotel Calipolis','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('27',NULL,'20300643G','11600283R','12000922R','3','Hotel Calipolis','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('28',NULL,'20400453H','12700123A','13100121L','3','Hotel Calipolis','Victòria','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('29',NULL,'20400453H','11500678S','10000456H','4','Hotel Montserrat','Ducci','0');
INSERT INTO "PARTIDA" ("ID", "GUANYADOR", "JUTGE", "BLANQUES", "NEGRES", "JORNADA", "HOTEL", "SALA", "ENTRADES_VENUDES") VALUES ('30',NULL,'20300643G','13100121L','11600283R','4','Hotel Montserrat','Ducci','0');

